<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shawty Shop | ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</title>
  <link rel="stylesheet" href="style.css" />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
  />
</head>

<body>
  <!-- üîπ Navbar -->
  <header class="navbar">
    <div class="navbar-top">
      <div class="logo">
        <img src="../assets/image/star icon.jpg" alt="logo">
        <h1>Shawty Shop</h1>
      </div>

      <div class="nav-icons">
        <a id="cart-btn" class="cart-icon" role="button" aria-label="cart">
          <i class="bi bi-cart3"></i>
          <span id="cart-count">0</span>
        </a>
        <a id="profile-link" class="profile-icon" role="button" aria-label="profile">
          <i class="bi bi-person-circle"></i>
        </a>
      </div>
    </div>

    <nav class="navbar-bottom">
      <a href="index.html" class="active">HOME</a>
      <a href="all.html">ALL</a>
    </nav>
  </header>

  <!-- üîπ Section: ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ -->
  <main class="container">
    <h1 class="section-title">üî• ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h1>
    <div id="product-grid" class="product-grid"></div>
  </main>

  <!-- üîπ Popup ‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô -->
  <div id="cart-popup" class="cart-popup hidden">
    <div class="cart-content">
      <button id="close-cart" class="close-btn" aria-label="close cart">&times;</button>
      <h2>‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
      <div id="cart-items" class="cart-items"></div>
      <div class="cart-buttons">
        <button id="checkout-btn" class="btn green">‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
        <button id="clear-cart" class="btn red">‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô</button>
      </div>
    </div>
  </div>

  <!-- üîπ Popup ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô) -->
  <div id="profile-popup" class="cart-popup hidden">
    <div class="cart-content">
      <button id="close-profile" class="close-btn" aria-label="close profile">&times;</button>
      <h2>‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
      <div id="profile-info" class="profile-info"></div>
      <div class="cart-buttons">
        <button id="go-profile-page" class="btn">‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</button>
        <button id="logout-btn" class="btn red">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </div>

  <!-- üîπ Toast -->
  <div id="toast" class="toast"></div>

  <!-- ===========================
       Script: ‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô
  ============================ -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const cartBtn = document.getElementById("cart-btn");
      const cartPopup = document.getElementById("cart-popup");
      const closeCart = document.getElementById("close-cart");

      if (!cartBtn || !cartPopup || !closeCart) return;

      // ‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î popup ‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô
      cartBtn.addEventListener("click", () => {
        cartPopup.classList.remove("hidden");
      });

      // ‚úÖ ‡∏õ‡∏¥‡∏î popup ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏Å‡∏ö‡∏≤‡∏ó
      closeCart.addEventListener("click", () => {
        cartPopup.classList.add("hidden");
      });

      // ‚úÖ ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ó‡∏≤‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î popup ‡∏î‡πâ‡∏ß‡∏¢
      cartPopup.addEventListener("click", (e) => {
        if (e.target.id === "cart-popup") {
          cartPopup.classList.add("hidden");
        }
      });
    });
  </script>

  <!-- ===========================
       Script: ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  ============================ -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const productGrid = document.getElementById("product-grid");
      const products = JSON.parse(localStorage.getItem("products")) || [];

      // ‚úÖ ‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ page = "index" ‡∏´‡∏£‡∏∑‡∏≠ "both"
      const featured = products.filter(p => p.page === "index" || p.page === "both");

      if (featured.length === 0) {
        productGrid.innerHTML = `<p class="text-center text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</p>`;
        return;
      }

      // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
      productGrid.innerHTML = featured.map(p => `
        <div class="product-card">
          <img src="${p.image}" alt="${p.name}">
          <h2>${p.name}</h2>
          <p>‡∏ø${p.price}</p>
          <button class="add-to-cart">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô</button>
        </div>
      `).join("");
    });
  </script>

  <!-- ===========================
       Script: ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ç‡∏≠)
  ============================ -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const profileLink = document.getElementById("profile-link");
      const profilePopup = document.getElementById("profile-popup");
      const closeProfile = document.getElementById("close-profile");
      const profileInfo = document.getElementById("profile-info");
      const logoutBtn = document.getElementById("logout-btn");
      const goProfilePageBtn = document.getElementById("go-profile-page");

      if (!profileLink) return;

      // üëâ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
      profileLink.addEventListener("click", () => {
        const user = JSON.parse(localStorage.getItem("user"));
        if (!user) {
          // ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‚Üí ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ login
          window.location.href = "login.html";
          return;
        }

        // ‚úÖ ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î popup ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        if (profilePopup && profileInfo) {
          profileInfo.innerHTML = `
            <p><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</strong> ${user.username || "-"}</p>
            <p><strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</strong> ${user.email || "-"}</p>
          `;
          profilePopup.classList.remove("hidden");
        }
      });

      // ‡∏õ‡∏¥‡∏î popup ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
      if (closeProfile && profilePopup) {
        closeProfile.addEventListener("click", () => profilePopup.classList.add("hidden"));
        profilePopup.addEventListener("click", (e) => {
          if (e.target.id === "profile-popup") {
            profilePopup.classList.add("hidden");
          }
        });
      }

      // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏ï‡πá‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
      if (goProfilePageBtn) {
        goProfilePageBtn.addEventListener("click", () => {
          window.location.href = "profile.html";
        });
      }

      // ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
      if (logoutBtn) {
        logoutBtn.addEventListener("click", () => {
          localStorage.removeItem("user");
          // ‡∏õ‡∏¥‡∏î popup ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏≤‡πÑ‡∏õ login
          if (profilePopup) profilePopup.classList.add("hidden");
          window.location.href = "login.html";
        });
      }
    });
  </script>
</body>
</html>
